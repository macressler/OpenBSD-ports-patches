$OpenBSD: patch-src_polkitbackend_polkitbackendjsauthority_c,v 1.6 2014/01/19 10:30:53 ajacoutot Exp $

From 1986e443b170240e9ce4a34726b7fa6c55b3601c Mon Sep 17 00:00:00 2001
From: Miloslav Trmaƒç <mitr@redhat.com>
Date: Sat, 07 Dec 2013 03:21:10 +0000
Subject: Fix a memory leak

--- src/polkitbackend/polkitbackendjsauthority.c.orig	Mon May  6 20:28:21 2013
+++ src/polkitbackend/polkitbackendjsauthority.c	Sun Jan 19 11:24:28 2014
@@ -24,7 +24,11 @@
 #include <errno.h>
 #include <pwd.h>
 #include <grp.h>
+#if defined __OpenBSD__
+#include <netgroup.h>
+#else
 #include <netdb.h>
+#endif
 #include <string.h>
 #include <glib/gstdio.h>
 #include <locale.h>
@@ -1286,7 +1290,7 @@ get_signal_name (gint signal_number)
     _HANDLE_SIG (SIGTTIN);
     _HANDLE_SIG (SIGTTOU);
     _HANDLE_SIG (SIGBUS);
-    _HANDLE_SIG (SIGPOLL);
+    _HANDLE_SIG (SIGIO);
     _HANDLE_SIG (SIGPROF);
     _HANDLE_SIG (SIGSYS);
     _HANDLE_SIG (SIGTRAP);
@@ -1362,7 +1366,6 @@ js_polkit_spawn (JSContext  *cx,
           JS_ReportError (cx, "Element %d is not a string", n);
           goto out;
 	}
-      s = JS_EncodeString (cx, JSVAL_TO_STRING (elem_val));
       s = JS_EncodeString (cx, JSVAL_TO_STRING (elem_val));
       argv[n] = g_strdup (s);
       JS_free (cx, s);

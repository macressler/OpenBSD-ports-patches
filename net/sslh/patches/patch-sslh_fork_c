--- sslh-fork.c.orig	Sat Nov 26 22:16:43 2011
+++ sslh-fork.c	Fri Mar 23 19:53:57 2012
@@ -138,6 +138,7 @@
     int in_socket, i, res;
     struct sigaction action;
 
+    listener_pid_number = num_addr_listen;
     listener_pid = malloc(listener_pid_number * sizeof(listener_pid[0]));
 
     /* Start one process for each listening address */
@@ -170,11 +171,9 @@
     res = sigaction(SIGTERM, &action, NULL);
     CHECK_RES_DIE(res, "sigaction");
 
-    listener_pid_number = num_addr_listen;
     wait(NULL);
 }
 
 /* The actual main is in common.c: it's the same for both version of
  * the server
  */
-

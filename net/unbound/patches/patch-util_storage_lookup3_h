$OpenBSD: patch-util_storage_lookup3_h,v 1.1 2012/01/10 22:15:54 sthen Exp $

Fix to randomize hash function, based on 28c3 congress, reported
by Peter van Dijk.

--- util/storage/lookup3.h.orig	Wed Jan  4 17:16:41 2012
+++ util/storage/lookup3.h	Wed Jan  4 17:16:56 2012
@@ -61,4 +61,11 @@ uint32_t hashword(const uint32_t *k, size_t length, ui
  */
 uint32_t hashlittle(const void *k, size_t length, uint32_t initval);
 
+/**
+ * Set the randomisation initial value, set this before threads start,
+ * and before hashing stuff (because it changes subsequent results).
+ * @param v: value
+ */
+void hash_set_raninit(uint32_t v);
+
 #endif /* UTIL_STORAGE_LOOKUP3_H */

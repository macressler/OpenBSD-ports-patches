$OpenBSD: patch-pf_obsdrdr_c,v 1.1.1.1 2012/01/13 09:22:50 ajacoutot Exp $
--- pf/obsdrdr.c.orig	Wed Jun 22 23:20:27 2011
+++ pf/obsdrdr.c	Sun Jan  8 10:18:32 2012
@@ -33,6 +33,8 @@
  *   Must be set with OpenBSD version 4.0 and up.
  * - PF_NEWSSTYLE
  *   Must be set with OpenBSD version 4.7 and up.
+ * - PFRULE_HAS_ONRDOMAIN
+ *   Must be set with OpenBSD version 5.0 and up.
  */
 
 #include <sys/types.h>
@@ -248,6 +250,9 @@ add_redirect_rule2(const char * ifname,
 #ifdef PFRULE_HAS_RTABLEID
 		pcr.rule.rtableid = -1;	/* first appeared in OpenBSD 4.0 */
 #endif
+#ifdef PFRULE_HAS_ONRDOMAIN
+		pcr.rule.onrdomain = -1;	/* first appeared in OpenBSD 5.0 */
+#endif
 		pcr.rule.quick = 1;
 		pcr.rule.keep_state = PF_STATE_NORMAL;
 		if(tag)
@@ -377,6 +382,9 @@ add_filter_rule2(const char * ifname,
 		pcr.rule.flagset = (TH_SYN|TH_ACK);
 #ifdef PFRULE_HAS_RTABLEID
 		pcr.rule.rtableid = -1;	/* first appeared in OpenBSD 4.0 */ 
+#endif
+#ifdef PFRULE_HAS_ONRDOMAIN
+		pcr.rule.onrdomain = -1;	/* first appeared in OpenBSD 5.0 */
 #endif
 		pcr.rule.keep_state = 1;
 		strlcpy(pcr.rule.label, desc, PF_RULE_LABEL_SIZE);

$OpenBSD: patch-src_client_parse_c,v 1.1 2013/09/12 17:03:45 sthen Exp $

From d48a58508e806685e80dbc449fdddfb152c266c0 Mon Sep 17 00:00:00 2001
From: Holger Wei√ü <holger@weiss.in-berlin.de>
Date: Thu, 12 Sep 2013 15:27:27 +0100
Subject: Cast time_t value to unsigned long for *printf(3)

--- src/client/parse.c.orig	Fri Feb  8 15:35:32 2013
+++ src/client/parse.c	Thu Sep 12 17:40:43 2013
@@ -56,7 +56,8 @@ parse_command(const char *line)
 	if (line[0] == '[')
 		command = xstrdup(line);
 	else
-		xasprintf(&command, "[%lu] %s", time(NULL), line);
+		xasprintf(&command, "[%lu] %s", (unsigned long)time(NULL),
+		    line);
 
 	return command;
 }
@@ -97,7 +98,7 @@ parse_check_result(const char *input, char delimiter)
 		debug("Got host check result");
 		xasprintf(&command,
 		    "[%lu] PROCESS_HOST_CHECK_RESULT;%.*s;%.*s;%s",
-		    time(NULL),
+		    (unsigned long)time(NULL),
 		    lengths[0], fields[0],
 		    lengths[1], fields[1],
 		    fields[2]);
@@ -106,7 +107,7 @@ parse_check_result(const char *input, char delimiter)
 		debug("Got service check result");
 		xasprintf(&command,
 		    "[%lu] PROCESS_SERVICE_CHECK_RESULT;%.*s;%.*s;%.*s;%s",
-		    time(NULL),
+		    (unsigned long)time(NULL),
 		    lengths[0], fields[0],
 		    lengths[1], fields[1],
 		    lengths[2], fields[2],

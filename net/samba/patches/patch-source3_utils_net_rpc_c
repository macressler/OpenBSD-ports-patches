$OpenBSD: patch-source3_utils_net_rpc_c,v 1.1 2014/02/06 04:33:25 brad Exp $

DCE-RPC fragment length field is incorrectly checked.
CVE-2013-4408

--- source3/utils/net_rpc.c.orig	Tue Jan 28 02:16:43 2014
+++ source3/utils/net_rpc.c	Tue Jan 28 02:16:43 2014
@@ -2889,7 +2889,12 @@ static NTSTATUS rpc_list_group_members(struct net_cont
 		if (!NT_STATUS_IS_OK(result)) {
 			return result;
 		}
-
+		if (names.count != this_time) {
+			return NT_STATUS_INVALID_NETWORK_RESPONSE;
+		}
+		if (types.count != this_time) {
+			return NT_STATUS_INVALID_NETWORK_RESPONSE;
+		}
 		/* We only have users as members, but make the output
 		   the same as the output of alias members */
 

$OpenBSD: patch-mail_e-mail-backend_c,v 1.1 2013/01/30 07:21:01 ajacoutot Exp $

From 0559de901e376c897515d684b357e6d9566f3b89 Mon Sep 17 00:00:00 2001
From: Milan Crha <mcrha@redhat.com>
Date: Tue, 29 Jan 2013 15:52:45 +0000
Subject: Bug #692777 - Crash on folder rename

--- mail/e-mail-backend.c.orig	Sat Jan 19 18:35:13 2013
+++ mail/e-mail-backend.c	Wed Jan 30 07:35:04 2013
@@ -685,9 +685,6 @@ mail_backend_folder_renamed_cb (MailFolderCache *folde
 
 	g_list_free_full (list, (GDestroyNotify) g_object_unref);
 
-	g_free (old_uri);
-	g_free (new_uri);
-
 	/* Rename GalView files. */
 
 	for (ii = 0; ii < G_N_ELEMENTS (cachenames); ii++) {
@@ -703,6 +700,9 @@ mail_backend_folder_renamed_cb (MailFolderCache *folde
 		g_free (oldname);
 		g_free (newname);
 	}
+
+	g_free (old_uri);
+	g_free (new_uri);
 
 	/* This does something completely different.
 	 * XXX Make it a separate signal handler? */

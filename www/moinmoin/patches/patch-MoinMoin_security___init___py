$OpenBSD: patch-MoinMoin_security___init___py,v 1.2 2012/10/22 17:52:39 jasper Exp $

CVE-2012-4404, moinmoin incorrect ACL evaluation for virtual groups
http://hg.moinmo.in/moin/1.9/rev/7b9f39289e16

--- MoinMoin/security/__init__.py.orig	Tue Feb  7 22:36:48 2012
+++ MoinMoin/security/__init__.py	Mon Oct 22 19:49:17 2012
@@ -320,11 +320,12 @@ class AccessControlList:
                 handler = getattr(self, "_special_"+entry, None)
                 allowed = handler(request, name, dowhat, rightsdict)
             elif entry in groups:
-                if name in groups[entry]:
+                this_group = groups[entry]
+                if name in this_group:
                     allowed = rightsdict.get(dowhat)
                 else:
                     for special in self.special_users:
-                        if special in entry:
+                        if special in this_group:
                             handler = getattr(self, "_special_" + special, None)
                             allowed = handler(request, name, dowhat, rightsdict)
                             break # order of self.special_users is important

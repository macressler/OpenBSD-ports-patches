$OpenBSD: patch-mozilla_js_src_configure_in,v 1.6 2012/02/20 20:20:00 landry Exp $
--- mozilla/js/src/configure.in.orig	Wed Jan 18 10:41:15 2012
+++ mozilla/js/src/configure.in	Mon Jan 23 08:01:24 2012
@@ -1214,7 +1214,7 @@ WIN_TOP_SRC=
 MOZ_USER_DIR=".mozilla"
 
 MOZ_JS_LIBS='-L$(libdir) -lmozjs'
-MOZ_FIX_LINK_PATHS='-Wl,-rpath-link,$(LIBXUL_DIST)/bin -Wl,-rpath-link,$(prefix)/lib'
+MOZ_FIX_LINK_PATHS='-Wl,-rpath-link,$(LIBXUL_DIST)/bin -Wl,-rpath-link,$(PREFIX)/lib -L$(LIBXUL_DIST)/bin'
 
 MOZ_COMPONENT_NSPR_LIBS='-L$(LIBXUL_DIST)/bin $(NSPR_LIBS)'
 
@@ -2457,7 +2457,7 @@ ia64*-hpux*)
     ;;
 
 *-openbsd*)
-    DLL_SUFFIX=".so.1.0"
+    DLL_SUFFIX=".so.${SO_VERSION}"
     DSO_CFLAGS=''
     DSO_PIC_CFLAGS='-fPIC'
     DSO_LDOPTS='-shared -fPIC'
@@ -2731,7 +2731,7 @@ arm*-*)
     AC_DEFINE(JS_CPU_ARM)
     AC_DEFINE(JS_NUNBOX32)
     ;;
-sparc*-*)
+sparc-*)
     NANOJIT_ARCH=Sparc
     ENABLE_METHODJIT=1
     ENABLE_MONOIC=1
@@ -2932,6 +2932,20 @@ MOZ_SIZE_OF_TYPE(JS_BYTES_PER_DOUBLE, double, 6 8 10 1
 AC_CHECK_HEADERS(endian.h)
 if test "$ac_cv_header_endian_h" = yes; then
     AC_DEFINE(JS_HAVE_ENDIAN_H)
+fi
+
+AC_MSG_CHECKING(for machine/endian.h)
+AC_CACHE_VAL(ac_cv_header_machine_endian_h,
+ [AC_TRY_COMPILE([#include <sys/types.h>
+                  #include <machine/endian.h>],
+                 [int foo = 0;],
+                 [ac_cv_header_machine_endian_h = yes],
+                 [ac_cv_header_machine_endian_h = no])])
+if test "$ac_cv_header_machine_endian_h" = yes; then
+    AC_DEFINE(JS_HAVE_MACHINE_ENDIAN_H)
+    AC_MSG_RESULT(yes)
+else
+    AC_MSG_RESULT(no)
 fi
 
 AC_CHECK_HEADERS(sys/isa_defs.h)

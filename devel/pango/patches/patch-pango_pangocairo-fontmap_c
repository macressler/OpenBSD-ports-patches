$OpenBSD: patch-pango_pangocairo-fontmap_c,v 1.1 2013/03/21 17:52:41 ajacoutot Exp $

From 71006c534a5599f0a69f4bd9b6677b2a6ad5adb3 Mon Sep 17 00:00:00 2001
From: Behdad Esfahbod <behdad@behdad.org>
Date: Fri, 15 Mar 2013 10:03:52 +0000
Subject: Call g_type_init if necessary

--- pango/pangocairo-fontmap.c.orig	Mon Jan  7 20:07:35 2013
+++ pango/pangocairo-fontmap.c	Thu Mar 21 18:48:50 2013
@@ -66,6 +66,10 @@ pango_cairo_font_map_default_init (PangoCairoFontMapIf
 PangoFontMap *
 pango_cairo_font_map_new (void)
 {
+#if !GLIB_CHECK_VERSION (2, 35, 3)
+  /* Make sure that the type system is initialized */
+  g_type_init ();
+#endif
 #if defined(HAVE_CORE_TEXT) && defined (HAVE_CAIRO_QUARTZ)
   return g_object_new (PANGO_TYPE_CAIRO_CORE_TEXT_FONT_MAP, NULL);
 #elif defined(HAVE_CAIRO_WIN32)
@@ -99,6 +103,10 @@ pango_cairo_font_map_new (void)
 PangoFontMap *
 pango_cairo_font_map_new_for_font_type (cairo_font_type_t fonttype)
 {
+#if !GLIB_CHECK_VERSION (2, 35, 3)
+  /* Make sure that the type system is initialized */
+  g_type_init ();
+#endif
   switch ((int) fonttype)
   {
 #if defined(HAVE_CORE_TEXT) && defined (HAVE_CAIRO_QUARTZ)

$OpenBSD: patch-gio_kqueue_kqueue-thread_c,v 1.2 2012/03/12 07:21:06 ajacoutot Exp $
--- gio/kqueue/kqueue-thread.c.orig	Mon Mar 12 07:46:36 2012
+++ gio/kqueue/kqueue-thread.c	Mon Mar 12 07:46:36 2012
@@ -21,6 +21,7 @@
 *******************************************************************************/
 
 #include "config.h"
+#include <sys/types.h>
 #include <sys/event.h>
 #include <sys/time.h>
 #include <unistd.h>
@@ -228,8 +229,11 @@ _kqueue_thread_func (void *arg)
 
     if (ret == -1)
       {
-        KT_W ("kevent failed");
-        continue;
+        KT_W ("kevent failed: %d", errno);
+        if (errno == EINTR)
+          continue;
+        else
+          return NULL;
       }
 
     if (received.ident == fd)

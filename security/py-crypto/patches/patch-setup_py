$OpenBSD: patch-setup_py,v 1.8 2012/02/17 09:32:18 mpi Exp $
--- setup.py.orig	Fri Jan 13 18:21:31 2012
+++ setup.py	Wed Feb  8 17:26:19 2012
@@ -128,15 +128,14 @@ class PCTBuildExt (build_ext):
                 # the libtomcrypt code.
                 self.__add_compiler_option("-O")
             else:
-                # Speed up execution by tweaking compiler options.  This
-                # especially helps the DES modules.
-                self.__add_compiler_option("-O3")
-                self.__add_compiler_option("-fomit-frame-pointer")
                 # Don't include debug symbols unless debugging
                 self.__remove_compiler_option("-g")
                 # Don't include profiling information (incompatible with
                 # -fomit-frame-pointer)
                 self.__remove_compiler_option("-pg")
+                # Honor CFLAGS
+                for opt in os.getenv('CFLAGS').split():
+                    self.__add_compiler_option(opt)
             if USE_GCOV:
                 self.__add_compiler_option("-fprofile-arcs")
                 self.__add_compiler_option("-ftest-coverage")
@@ -371,9 +370,6 @@ kw = {'name':"pycrypto",
                       sources=["src/_fastmath.c"]),
 
             # Hash functions
-            Extension("Crypto.Hash._MD2",
-                      include_dirs=['src/'],
-                      sources=["src/MD2.c"]),
             Extension("Crypto.Hash._MD4",
                       include_dirs=['src/'],
                       sources=["src/MD4.c"]),
@@ -398,9 +394,10 @@ kw = {'name':"pycrypto",
             Extension("Crypto.Cipher.AES",
                       include_dirs=['src/'],
                       sources=["src/AES.c"]),
-            Extension("Crypto.Cipher.ARC2",
-                      include_dirs=['src/'],
-                      sources=["src/ARC2.c"]),
+# Patented
+#            Extension("Crypto.Cipher.ARC2",
+#                      include_dirs=['src/'],
+#                      sources=["src/ARC2.c"]),
             Extension("Crypto.Cipher.Blowfish",
                       include_dirs=['src/'],
                       sources=["src/Blowfish.c"]),

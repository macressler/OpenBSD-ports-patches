$OpenBSD: patch-src_status_cpp,v 1.1 2011/12/30 10:10:16 dcoppa Exp $

Bugfix: dollar sign in song title changes interface text colors
(upstream git commit e8f08ea8844ca878cc159babb68c033278d5b270)
cf. http://musicpd.org/mantis/view.php?id=3409

--- src/status.cpp.orig	Tue Oct 11 21:27:41 2011
+++ src/status.cpp	Fri Dec 30 10:45:05 2011
@@ -445,8 +445,8 @@ void NcmpcppStatusChanged(MPD::Connection *, MPD::Stat
 				}
 				
 				basic_buffer<my_char_t> first, second;
-				String2Buffer(TO_WSTRING(utf_to_locale_cpy(np.toString(Config.new_header_first_line))), first);
-				String2Buffer(TO_WSTRING(utf_to_locale_cpy(np.toString(Config.new_header_second_line))), second);
+				String2Buffer(TO_WSTRING(utf_to_locale_cpy(np.toString(Config.new_header_first_line, "$"))), first);
+				String2Buffer(TO_WSTRING(utf_to_locale_cpy(np.toString(Config.new_header_second_line, "$"))), second);
 				
 				size_t first_len = Window::Length(first.Str());
 				size_t first_margin = (std::max(tracklength.length()+1, VolumeState.length()))*2;
@@ -497,7 +497,7 @@ void NcmpcppStatusChanged(MPD::Connection *, MPD::Stat
 					tracklength += "]";
 				}
 				basic_buffer<my_char_t> np_song;
-				String2Buffer(TO_WSTRING(utf_to_locale_cpy(np.toString(Config.song_status_format))), np_song);
+				String2Buffer(TO_WSTRING(utf_to_locale_cpy(np.toString(Config.song_status_format, "$"))), np_song);
 				*wFooter << XY(0, 1) << wclrtoeol << player_state << fmtBoldEnd;
 				np_song.Write(*wFooter, playing_song_scroll_begin, wFooter->GetWidth()-player_state.length()-tracklength.length(), U(" ** "));
 				*wFooter << fmtBold << XY(wFooter->GetWidth()-tracklength.length(), 1) << tracklength;

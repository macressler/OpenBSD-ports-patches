$OpenBSD: patch-scripts_mysqld_safe_sh,v 1.1.1.1 2013/04/04 18:58:44 brad Exp $
--- scripts/mysqld_safe.sh.orig	Mon Mar 11 06:29:14 2013
+++ scripts/mysqld_safe.sh	Sun Mar 17 01:30:25 2013
@@ -23,7 +23,8 @@ mysqld_ld_library_path=
 logging=init
 want_syslog=0
 syslog_tag=
-user='@MYSQLD_USER@'
+user='_mysql'
+group='_mysql'
 pid_file=
 err_log=
 
@@ -637,8 +638,8 @@ then
     echo "Fatal error Can't create database directory '$mysql_unix_port'"
     exit 1
   fi
-  chown $user $mysql_unix_port_dir
-  chmod 755 $mysql_unix_port_dir
+  chown $user:$group $mysql_unix_port_dir
+  chmod 711 $mysql_unix_port_dir
 fi
 
 # If the user doesn't specify a binary, we assume name "mysqld"
@@ -846,35 +847,6 @@ do
     fi
   fi
 
-  if @TARGET_LINUX@ && test $KILL_MYSQLD -eq 1
-  then
-    # Test if one process was hanging.
-    # This is only a fix for Linux (running as base 3 mysqld processes)
-    # but should work for the rest of the servers.
-    # The only thing is ps x => redhat 5 gives warnings when using ps -x.
-    # kill -9 is used or the process won't react on the kill.
-    numofproces=`ps xaww | grep -v "grep" | grep "$ledir/$MYSQLD\>" | grep -c "pid-file=$pid_file"`
-
-    log_notice "Number of processes running now: $numofproces"
-    I=1
-    while test "$I" -le "$numofproces"
-    do 
-      PROC=`ps xaww | grep "$ledir/$MYSQLD\>" | grep -v "grep" | grep "pid-file=$pid_file" | sed -n '$p'` 
-
-      for T in $PROC
-      do
-        break
-      done
-      #    echo "TEST $I - $T **"
-      if kill -9 $T
-      then
-        log_error "$MYSQLD process hanging, pid $T - killed"
-      else
-        break
-      fi
-      I=`expr $I + 1`
-    done
-  fi
   log_notice "mysqld restarted"
   if test -n "$CRASH_SCRIPT"
   then

$OpenBSD: patch-src_click_c,v 1.6 2012/02/21 14:05:39 dcoppa Exp $

Bugfix: highlight i3bar workspace when changing output with mouse
(upstream git commit 51e6e489927f93e265f3258b309d2e23d07b65ad)

--- src/click.c.orig	Tue Feb 21 14:13:05 2012
+++ src/click.c	Tue Feb 21 14:13:48 2012
@@ -199,12 +199,18 @@ static int route_click(Con *con, xcb_button_press_even
         goto done;
     }
 
-    /* 2: focus this con */
+    /* 2: focus this con. If the workspace is on another output we need to
+     * do a workspace_show in order for i3bar (and others) to notice the
+     * change in workspace. */
+    Con *ws = con_get_workspace(con);
+    Con *focused_workspace = con_get_workspace(focused);
+
+    if (ws != focused_workspace)
+        workspace_show(ws);
     con_focus(con);
 
     /* 3: For floating containers, we also want to raise them on click.
      * We will skip handling events on floating cons in fullscreen mode */
-    Con *ws = con_get_workspace(con);
     Con *fs = (ws ? con_get_fullscreen_con(ws, CF_OUTPUT) : NULL);
     if (floatingcon != NULL && fs == NULL) {
         floating_raise_con(floatingcon);

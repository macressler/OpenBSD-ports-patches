$OpenBSD: patch-dbus_dbus-marshal-recursive-util_c,v 1.1 2013/12/08 10:42:34 ajacoutot Exp $

From 7c00ed22d9b5c33f5b33221e906946b11a9bde3b Mon Sep 17 00:00:00 2001
From: DreamNik <dreamnik@mail.ru>
Date: Sun, 29 Sep 2013 10:45:58 +0000
Subject: make_and_run_test_nodes: avoid undefined behaviour

--- dbus/dbus-marshal-recursive-util.c.orig	Wed Jun  6 12:45:55 2012
+++ dbus/dbus-marshal-recursive-util.c	Sun Dec  8 10:55:09 2013
@@ -1785,10 +1785,13 @@ make_and_run_test_nodes (void)
   start_next_test ("All values in one big toplevel %d iteration\n", 1);
   {
     TestTypeNode *nodes[N_VALUES];
+    TestTypeNode *node;
 
     i = 0;
-    while ((nodes[i] = value_generator (&i)))
-      ;
+    while ((node = value_generator (&i)))
+      {
+        nodes[i - 1] = node;
+      }
 
     run_test_nodes (nodes, N_VALUES);
 

$OpenBSD: patch-Alacarte_MainWindow_py,v 1.4 2013/03/11 09:37:03 ajacoutot Exp $

From f7835d7dcd37b10f25e208581ec52919cf68e732 Mon Sep 17 00:00:00 2001
From: Jasper St. Pierre <jstpierre@mecheye.net>
Date: Sat, 17 Nov 2012 04:22:14 +0000
Subject: Fix crashes when writing out files

From 10f611c074ae7b2ab0ec48ff3b8946c5f8e19970 Mon Sep 17 00:00:00 2001
From: Jasper St. Pierre <jstpierre@mecheye.net>
Date: Sat, 17 Nov 2012 04:26:14 +0000
Subject: Use with statements for management

--- Alacarte/MainWindow.py.orig	Mon Mar 11 09:45:41 2013
+++ Alacarte/MainWindow.py	Mon Mar 11 09:45:33 2013
@@ -19,6 +19,7 @@
 
 from gi.repository import Gtk, GObject, Gio, GdkPixbuf, Gdk, GMenu, GLib
 import cgi
+import codecs
 import os
 import gettext
 import subprocess
@@ -319,7 +320,8 @@ class MainWindow(object):
 
         if not os.path.isfile(file_path):
             data = open(item.get_desktop_file_path()).read()
-            open(file_path, 'w').write(data)
+            with codecs.open(file_path, 'w', 'utf8') as f:
+                f.write(data)
 
         if file_path not in self.edit_pool:
             self.edit_pool.append(file_path)

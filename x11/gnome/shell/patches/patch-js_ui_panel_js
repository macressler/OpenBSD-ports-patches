$OpenBSD: patch-js_ui_panel_js,v 1.8 2013/08/06 18:09:20 jasper Exp $

Make Network Manager support optional.
https://bugzilla.gnome.org/show_bug.cgi?id=679871

--- js/ui/panel.js.orig	Wed Jul 31 00:20:54 2013
+++ js/ui/panel.js	Wed Jul 31 07:54:06 2013
@@ -933,11 +933,13 @@ if (Config.HAVE_BLUETOOTH)
     PANEL_ITEM_IMPLEMENTATIONS['bluetooth'] =
         imports.ui.status.bluetooth.Indicator;
 
-try {
-    PANEL_ITEM_IMPLEMENTATIONS['network'] =
-        imports.ui.status.network.NMApplet;
-} catch(e) {
-    log('NMApplet is not supported. It is possible that your NetworkManager version is too old');
+if (Config.HAVE_NETWORK_MANAGER) {
+    try {
+        PANEL_ITEM_IMPLEMENTATIONS['network'] =
+            imports.ui.status.network.NMApplet;
+    } catch(e) {
+        log('NMApplet is not supported. It is possible that your NetworkManager version is too old');
+    }
 }
 
 const Panel = new Lang.Class({

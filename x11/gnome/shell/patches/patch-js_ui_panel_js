$OpenBSD: patch-js_ui_panel_js,v 1.7 2013/05/14 08:59:45 jasper Exp $

Make Network Manager support optional.
https://bugzilla.gnome.org/show_bug.cgi?id=679871

--- js/ui/panel.js.orig	Tue May 14 00:43:35 2013
+++ js/ui/panel.js	Tue May 14 10:00:35 2013
@@ -932,11 +932,13 @@ if (Config.HAVE_BLUETOOTH)
     PANEL_ITEM_IMPLEMENTATIONS['bluetooth'] =
         imports.ui.status.bluetooth.Indicator;
 
-try {
-    PANEL_ITEM_IMPLEMENTATIONS['network'] =
-        imports.ui.status.network.NMApplet;
-} catch(e) {
-    log('NMApplet is not supported. It is possible that your NetworkManager version is too old');
+if (Config.HAVE_NETWORK_MANAGER) {
+    try {
+        PANEL_ITEM_IMPLEMENTATIONS['network'] =
+            imports.ui.status.network.NMApplet;
+    } catch(e) {
+        log('NMApplet is not supported. It is possible that your NetworkManager version is too old');
+    }
 }
 
 const Panel = new Lang.Class({

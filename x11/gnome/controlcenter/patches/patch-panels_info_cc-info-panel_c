$OpenBSD: patch-panels_info_cc-info-panel_c,v 1.4 2011/11/09 09:01:59 ajacoutot Exp $

No PackageKit on OpenBSD.

--- panels/info/cc-info-panel.c.orig	Tue Nov  8 21:20:01 2011
+++ panels/info/cc-info-panel.c	Wed Nov  9 08:52:05 2011
@@ -23,7 +23,12 @@
 
 #include "cc-info-panel.h"
 
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
+#include <sys/param.h>
+#include <sys/mount.h>
+#else
 #include <sys/vfs.h>
+#endif
 #include <polkit/polkit.h>
 
 #include <glib.h>
@@ -1282,6 +1287,7 @@ on_pk_get_updates_ready (GObject      *source,
                          GAsyncResult *res,
                          CcInfoPanel  *self)
 {
+#ifndef __OpenBSD__
   GError     *error;
   GVariant   *result;
 
@@ -1293,6 +1299,9 @@ on_pk_get_updates_ready (GObject      *source,
       g_error_free (error);
       return;
     }
+#else
+  return;
+#endif
 }
 
 static void
@@ -1300,6 +1309,7 @@ on_pk_get_tid_ready (GObject      *source,
                      GAsyncResult *res,
                      CcInfoPanel  *self)
 {
+#ifndef __OpenBSD__
   GError     *error;
   GVariant   *result;
   char       *tid;
@@ -1346,6 +1356,9 @@ on_pk_get_tid_ready (GObject      *source,
                      NULL,
                      (GAsyncReadyCallback) on_pk_get_updates_ready,
                      self);
+#else
+  return;
+#endif
 }
 
 static void
@@ -1408,6 +1421,7 @@ cc_info_panel_init (CcInfoPanel *self)
 
   g_assert (self->priv->session_bus);
 
+#ifndef __OpenBSD__
   self->priv->pk_proxy = g_dbus_proxy_new_for_bus_sync (G_BUS_TYPE_SYSTEM,
                                                         G_DBUS_PROXY_FLAGS_NONE,
                                                         NULL,
@@ -1429,6 +1443,7 @@ cc_info_panel_init (CcInfoPanel *self)
                         self);
       refresh_updates (self);
     }
+#endif
 
   gtk_builder_add_from_file (self->priv->builder,
                              GNOMECC_UI_DIR "/info.ui",
@@ -1443,8 +1458,10 @@ cc_info_panel_init (CcInfoPanel *self)
 
   self->priv->graphics_data = get_graphics_data ();
 
+#ifndef __OpenBSD__
   widget = WID ("updates_button");
   g_signal_connect (widget, "clicked", G_CALLBACK (on_updates_button_clicked), self);
+#endif
 
   info_panel_setup_selector (self);
   info_panel_setup_overview (self);

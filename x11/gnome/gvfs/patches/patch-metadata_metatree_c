$OpenBSD: patch-metadata_metatree_c,v 1.8 2012/10/01 10:54:30 ajacoutot Exp $

From a5e21447be3c138969e80a3f779c8697b551db4f Mon Sep 17 00:00:00 2001
From: Antoine Jacoutot <ajacoutot@gnome.org>
Date: Sun, 30 Sep 2012 08:52:39 +0000
Subject: portability: fix is_on_nfs on OpenBSD

--- metadata/metatree.c.orig	Mon Sep 24 15:04:39 2012
+++ metadata/metatree.c	Sun Sep 30 10:42:21 2012
@@ -302,7 +302,11 @@ is_on_nfs (char *filename)
 			  sizeof (statfs_buffer), 0);
 # endif
   if (statfs_result == 0)
+#ifdef __OpenBSD__
+    res = strcmp(statfs_buffer.f_fstypename, MOUNT_NFS) == 0;
+#else
     res = statfs_buffer.f_type == 0x6969;
+#endif
 
 #elif defined(USE_STATVFS) && defined(HAVE_STRUCT_STATVFS_F_BASETYPE)
   statfs_result = statvfs (dirname, &statfs_buffer);

$OpenBSD: patch-daemon_gdm-session_c,v 1.1 2013/05/17 14:55:58 ajacoutot Exp $

From 8b0fbe27f0fbaa09dfcfd0485c4ca06982c0ffe9 Mon Sep 17 00:00:00 2001
From: Colin Walters <walters@verbum.org>
Date: Mon, 29 Apr 2013 20:49:46 +0000
Subject: session: Don't accept empty string as saved language

--- daemon/gdm-session.c.orig	Wed Jan  2 00:36:25 2013
+++ daemon/gdm-session.c	Fri May 17 16:40:21 2013
@@ -887,8 +887,8 @@ worker_on_saved_language_name_read (GdmDBusWorker     
 {
         GdmSession *self = conversation->session;
 
-        if (strcmp (language_name,
-                    get_default_language_name (self)) != 0) {
+        if (strlen (language_name) > 0 &&
+            strcmp (language_name, get_default_language_name (self)) != 0) {
                 g_free (self->priv->saved_language);
                 self->priv->saved_language = g_strdup (language_name);
 
